<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/prism.css /><link rel='stylesheet' href=../../../css/index.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">

</head>

<body class="light">
    <div class='markdown-body'><h1>build</h1><p>VMware Workstation + Ubuntu16.04 + Linux5.4.19</p><blockquote><p>不要编译低版本内核, 不要编译...</p></blockquote><h2>基本环境搭建</h2><p>编译内核的配一个Linux环境应该不是问题了,略过</p><p><b>注意</b>, 不要选择高版本的Ubuntu,因为</p><p>如果是虚拟机的话内存(swap area)划大一些(8GB)</p><h2>下载Linux内核源代码</h2><p>本文以5.4.19版本Linux内核源代码为例, 可以在 <a href="https://mirrors.edge.kernel.org/pub/linux/kernel/" target="_blank">Linux Kernel</a> 找到所有版本</p><pre><code class="language-bash">wget https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.4.19.tar.gz
tar xf linux-5.4.19.tar.gz
cd linux-5.4.19</code></pre><h2>安装编译依赖</h2><pre><code class="language-UNKNOWN">sudo apt update
sudo apt-get install git fakeroot build-essential ncurses-dev xz-utils libssl-dev bc flex libelf-dev bison vim</code></pre><p>编译选项和编译</p><pre><code class="language-bash">make menuconfig</code></pre><p>打开后不做修改,save,exit,得到.config文件</p><pre><code class="language-bash">make -j`nproc`</code></pre><p>可以得到 <code>vmlinux</code> 和 <code>arch/x86/boot/bzImage</code></p><p><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20230301013759.png" alt="20230301013759"></p><p>vmlinux和bzImage都是Linux内核编译生成的可执行文件，它们的主要区别在于它们的文件格式和用途。</p><p>vmlinux是Linux内核编译生成的未压缩的内核镜像文件，它包含了整个内核的代码和数据，可以用来调试内核。它通常比较大，因为它没有被压缩。</p><p>bzImage是Linux内核编译生成的压缩内核镜像文件，它是用来引导启动Linux操作系统的。它是通过将vmlinux压缩成一个单独的文件，并添加一些引导代码和头部信息来生成的。</p><p>当系统引导时，bzImage首先会被加载到内存中，然后被解压缩成vmlinux形式的内核映像。因为vmlinux文件比较大，而且内核启动过程中需要加载和解压缩文件，所以bzImage文件通常比vmlinux文件小很多。</p><p>因此，vmlinux主要用于内核开发和调试，而bzImage则是用于实际的Linux操作系统启动。</p><p><a href="https://blog.csdn.net/weixin_60043341/article/details/126386952" target="_blank">https://blog.csdn.net/weixin_60043341/article/details/126386952</a></p><h2>可能遇到的问题</h2><ul><li><a href="https://blog.csdn.net/nongchaoer201012/article/details/114609518" target="_blank">https://blog.csdn.net/nongchaoer201012/article/details/114609518</a></li></ul><ul><li><a href="https://blog.csdn.net/Luckiers/article/details/124544179" target="_blank">https://blog.csdn.net/Luckiers/article/details/124544179</a></li></ul><ul><li><a href="https://www.zhihu.com/search?q=%E7%BC%96%E8%AF%91linux%E5%86%85%E6%A0%B8&type=content&vertical=article" target="_blank">https://www.zhihu.com/search?q=%E7%BC%96%E8%AF%91linux%E5%86%85%E6%A0%B8&type=content&vertical=article</a></li></ul></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../md-docs/00-环境配置" >00-环境配置</a></li></ul><ul><li><a href="../../md-docs/01-module" >01-module</a></li></ul><ul><li><a href="../../md-docs/02-export" >02-export</a></li></ul><ul><li><a href="../../md-docs/03-params" >03-params</a></li></ul><ul><li><a href="../../md-docs/04-字符设备号" >04-字符设备号</a></li></ul><ul><li><a href="../../md-docs/05-字符设备架构" >05-字符设备架构</a></li></ul><ul><li><a href="../../md-docs/06-字符设备注册" >06-字符设备注册</a></li></ul><ul><li><a href="../../md-docs/07-自动创建设备节点" >07-自动创建设备节点</a></li></ul><ul><li><a href="../../md-docs/08-读写" >08-读写</a></li></ul><ul><li><a href="../../md-docs/PCI驱动" >PCI驱动</a></li></ul><ul><li><a href="../../linux-kernel/build" >linux-kernel</a><ul><li><a href="../../linux-kernel/build" >build</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../md-docs/PCI驱动",".","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/prism.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/check_box.js"></script>
    <script type="module">
        const codeBlocks = document.querySelectorAll('.language-mermaid');
        codeBlocks.forEach(codeBlock => {
            codeBlock.classList.remove('language-mermaid');
            codeBlock.classList.add('mermaid');
        });
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>

</html>